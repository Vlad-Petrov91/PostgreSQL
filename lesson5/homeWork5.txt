1)
CREATE ROLE analyst;
CREATE ROLE tester;

CREATE ROLE serovf LOGIN;
CREATE ROLE belovr LOGIN;

ALTER ROLE serovf WITH PASSWORD '12345';
ALTER ROLE belovr WITH PASSWORD '54321';

GRANT analyst TO serovf;
GRANT tester TO belovr;

\c vk

GRANT ALL ON ALL TABLES IN SCHEMA public TO tester;
GRANT ALL ON ALL SEQUENCES IN SCHEMA public TO tester;

GRANT SELECT ON ALL TABLES IN SCHEMA public TO analyst;
\q

psql -U serovf -d vk -h 127.0.0.1 -W
SELECT * FROM users WHERE id = 5;
UPDATE users SET first_name = 'John' WHERE id = 5; (error т.к. нет прав)
\q

psql -U belovr -d vk -h 127.0.0.1 -W
SELECT * FROM users WHERE id = 5;
UPDATE users SET first_name = 'John' WHERE id = 5;

2)
CREATE EXTENSION "citext";

3)
CREATE TABLE profiles (
  user_id INT NOT NULL,
  main_photo_id INT,
  created_at TIMESTAMP,
  PRIMARY KEY (user_id)
);

ALTER TABLE profiles
ADD CONSTRAINT profiles_user_id_fk
  FOREIGN KEY (user_id)
  REFERNCES users (id);

ALTER TABLE profiles
ADD CONSTRAINT main_photo_id_fk
  FOREIGN KEY (main_photo_id)
  REFERNCES photos (id);

INSERT INTO profiles (user_id, main_photo_id, created_at)
SELECT id, main_photo_id, created_at FROM users;

ALTER TABLE users
  DROP COLUMN main_photo_id,
  DROP COLUMN created_at;

