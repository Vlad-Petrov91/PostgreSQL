1)
SELECT
    id,
    (SELECT first_name FROM users WHERE id = video.owner_id) AS name,
    (SELECT last_name FROM users WHERE id = video.owner_id) AS last_name,
    (SELECT url FROM photo WHERE id = video.owner_id) AS photo_url,
    url AS video_url,
    size 
FROM video
ORDER BY size 
DESC LIMIT 10;

2)
CREATE TEMPORARY TABLE big_video (
    id INT,
    size INT,
    owner_id INT,
    url VARCHAR(250)
);

INSERT INTO big_video
SELECT id, 
    size, 
    owner_id, 
    url
FROM video
ORDER BY size
DESC LIMIT 10;

SELECT * FROM big_video;

SELECT
    big_video.id,
    first_name AS name,
    last_name AS last_name,
    photo.url AS photo_url,
    big_video.url AS video_url,
    big_video.size
FROM users
JOIN big_video
ON big_video.owner_id = users.id
LEFT JOIN photo
ON photo.id = users.main_photo_id;

3)
SELECT video.id,
    first_name AS name,
    last_name AS sorname,
    photo.url AS photo_url,
    video.url AS video_url, 
    video.size FROM video
JOIN users ON video.owner_id = users.id
LEFT JOIN photo ON video.owner_id = photo.id
ORDER BY size
DESC LIMIT 10;

4)
WITH big_video AS
    (SELECT id, 
        url, 
        size, 
        owner_id 
    FROM video
    ORDER BY size
    DESC LIMIT 10)
SELECT big_video.id,
    first_name,
    last_name,
    photo.url AS photo_url,
    big_video.url AS video_url,
    big_video.size
FROM users
    JOIN big_video
    ON big_video.owner_id = users.id
LEFT JOIN photo
ON photo.id = users.main_photo_id
ORDER BY size DESC;








